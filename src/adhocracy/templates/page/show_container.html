<%inherit file="/template.html" />
<%namespace name="components" file="/components.html"/>
<%namespace name="index_tiles" file="/page/index_tiles.html"/>

<%def name="breadcrumbs()">${h.text.breadcrumbs(c.text)|n}</%def>

<%block name="headline">
<div class="morelink_header">
    <h2>
        ${c.page.title}
        <div class="utility">
            %if can.page.edit(c.page):
            <a href="${h.entity_url(c.page, member='edit')}">${_(u"Edit")}</a>
            %endif
            %if can.page.delete(c.page):
            <a href="${h.entity_url(c.page, member='ask_delete')}">${_(u"Delete")}</a>
            %endif
        </div>
    </h2>
    %if can.norm.create():
        <a class="more_link"
           href=${h.base_url('/page/new', query_params={'parent': c.page.id})}>${_("Create new norm")}</a>
    %endif
</div>

<img class="container_banner" alt="" src="${h.logo_url(c.page, 213, 960)}"/>
</%block>


<%block name="main_content">
<div class="paper_text">
    ${c.variant_details['text']|n}
</div>

%if c.instance.page_index_as_tiles:
${index_tiles.as_tiles(c.subpages_pager._items, columns=2)}
%else:
${c.subpages_pager.here()|n}
%endif

<div class="list_button">
%if can.norm.create():
    <a class="button title admin ttip" title="${_('Create a new norm.')}"
       href=${h.base_url('/page/new', query_params={'parent': c.page.id})}>${_("new norm")}</a>
%endif
</div>
</%block>


<%block name="sidebar">
<% current = h.config.get_json('adhocracy.urbanliving.grundstuecke').get(str(c.page.id), None) %>

%if current is not None:
<div class="sidebar_box">
    <h3>Informationen zum Grundstück</h3>
    <h6>Adresse</h6>
    <p>${current['name']}</p>

    <h6>Grundstücksgröße</h6>
    <p>${current['size']}</p>

    <h6>Eigentümerin</h6>
    <p>${current['owner']}</p>

    <h6>Bisherige Nutzung</h6>
    <p>${current['current_use']}</p>
</div>

<div class="sidebar_box">
    <h3>Ortsbezogene Herausforderungen</h3>

    <ul>
        %for challenge in current['challenges']:
        <li>${challenge}</li>
        %endfor
    </ul>
</div>

<div class="sidebar_box">
    <h3>Themen</h3>

    <%
        from adhocracy.model import CategoryBadge
        categories = CategoryBadge.all(instance=c.instance)
    %>
    <ul class="senat_icons">
        %for category in categories:
        <li>${components.senat_icon(category, highlight=category.id in current.get('categories', []), link=True)}</li>
        %endfor
    </ul>
</div>
%endif
</%block>
